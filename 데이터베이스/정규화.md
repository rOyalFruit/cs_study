## 관계

### 관계선

#### 1. 실선

> 실선은 `식별관계`를 나타냄 <br> `부모 테이블`의 기본키(PK)가 `자식 테이블`에 기본키, 외래키로 사용되는 경우 <br> `부모 테이블`과 `자식 테이블`의 강한 연결 관계를 나타낼 때 사용

#### 2. 점선

> 점선은 `비식별관계`를 나타냄 <br> `부모 테이블`의 기본키(PK)가 `자식 테이블`의 일반 속성이 되는 경우 <br> `부모 테이블`과 `자식테이블`의 약한 연결관계를 나타낼 때 사용

### 관계기호

#### 1. 1대1

> ![1대1(one)](https://github.com/user-attachments/assets/48a95943-bb51-4f1a-8e45-797675335c04)
 <br> ![1대1(and only one)](https://github.com/user-attachments/assets/5313eb52-f424-450f-98ed-111baa98b251)
 <br>
> 위의 2가지 표시 방법은 모두 `정확히 하나의 관계가 반드시 존재해야 함`을 의미

> ![1대1(one or zero)](https://github.com/user-attachments/assets/71357279-6e4a-4860-a1d7-db5ece95bac5)
 <br> `1개 이하의 관계를 이루고 있음`을 의미

#### 2. 1대N

> ![1대다(one or many)](https://github.com/user-attachments/assets/3bedcb23-77d8-43ce-9e5d-e8651ca449ab)
 <br> `1개 이상의 테이블과 관계를 이루고 있음`을 의미

> ![1대다(zero or many)](https://github.com/user-attachments/assets/4212b1d4-fbdf-48c9-8713-0a795fce3f0c)
 <br> `0개 이상의 테이블과 관계를 이루고 있음`을 의미

#### 3. N대M

> 두 entity가 N:M 관계를 가지는 형태 <br> 해당 경우는 데이터 모델링에서 완성되지 않은 모델로 간주 (데이터가 중복되어 버림) <br>
> 그렇기 떄문에 해당 관계는 연관 테이블을 추가하여 1:N, N:1 테이블로 조정하는 작업이 필요

---

## 키

![키 관계](https://github.com/user-attachments/assets/5d1cc9f6-2f12-43bd-801e-01d5d814c010)

[출처:https://data04190.tistory.com/90]

### 기본키 (Primary Key)

> `기본키` 혹은 `PK` 라고 부르며, 각 행을 유일하게 식별할 수 있는 `유일성`과 `최소성`을 만족하는 속성

- 유일성 (Uniqueness)

  - 하나의 키값으로 튜플(=레코드, 행)을 유일하게 식별할 수 있는 성질

- 최소성

  - 키를 구성하는 속성들 중 꼭 필요한 최소한의 속성들로만 키를 구성하는 성질

#### 1. 자연키

> 비즈니스 모델에서 자연스럽게 생성되는 속성 <br> 예시) Member 테이블의 email 값

#### 2. 인조키

> 키 역할을 수행하기 위해 인위적으로 생성된 속성 <br> 예시) UUID, Auto Increment

### 대체키 (Alternate Key)

> `후보키` 중에서 `기본키`로 선택된 키를 제외한 나머지 키 <br> `기본키`는 아니지만 기본키를 대신해서 사용 가능

### 외래키 (Foreign Key)

> `외래키` 혹은 `FK` 라고 부르며, 다른 릴레이션(=테이블)의 기본키를 그대로 참조하는 속성 또는 속성들의 집합

### 후보키 (Candidate Key)

> 각 행을 유일하게 식별할 수 있는 최소한의 속성들의 집합 <br> 즉, 슈퍼키 중 최소성을 만족하는 속성 또는 속성들의 집합을 뜻함

### 슈퍼키 (Super Key)

> 각 행을 유일하게 식별할 수 있는(= 유일성의 특성을 만족하는) 속성들의 집합

---

## 정규화

> 이상현상이 있는 릴레이션(=테이블)을 분해하여 이상현상을 없애는 과정

- 장점

  - 이상 현상을 제거할 수 있음
  - 정규화된 db 구조에서는 새로운 데이터 형의 추가로 인한 확장 시, 구조를 변경하지 않아도 되거나 일부만 변경해도 됨
  - db와 연동된 응용 프로그램에 최소한의 영향만을 미치게 되어 프로그램의 생명을 연장시킬 수 있음

- 단점
  - 릴레이션 간의 JOIN 연산이 많아짐
  - 질의에 대한 응답시간이 느려질 수 있음
  - 데이터 처리 시 속도가 불규칙해질 수 있음

### 제1 정규화 (1NF)

> 테이블의 column이 원자값(=하나의 값)을 갖도록 테이블을 분해하는 것
>
> 1. 각 column이 하나의 속성만을 가져야 함
> 2. 하나의 column은 같은 종류나 타입의 값을 가져야 함
> 3. 각 column이 유일한 이름을 가져야 함
> 4. column의 순서가 상관 없어야 함

### 제2 정규화 (2NF)

> 제1 정규화를 진행한 테이블에 대해 `완전 함수 종속`을 만족하도록 테이블을 분해하는 것
>
> 1. 제1 정규화를 만족해야 함
> 2. 모든 column이 `완전 함수 종속`을 만족해야 함

#### 완전 함수 종속이란?

> 어떤 column(=속성)이 기본키 전체에 대해 의존하는 경우를 뜻함 <br> 즉, 기본키의 일부가 아닌 전체가 있어야만 특정 속성을 결정할 수 있어야 `완전 함수 종속`이 됨

| 학생 ID | 과목 ID | 성적 |
| ------- | ------- | ---- |
| 1       | 101     | 90   |
| 1       | 102     | 85   |

- 기본키 : (학생 ID, 과목 ID) -> 복합키
- 성적 -> 기본키에 의해서 결정됨

> 성적은 학생 ID만으로, 과목 ID만으로 결정될 수 없음 <br> 즉, 기본키 전체가 있어야 알 수 있음

### 제3 정규화 (3NF)

> 제2 정규화를 진행한 테이블에 대해 `이행적 종속`을 없애도록 테이블을 분해하는 것

#### 이행적 종속이란?

> 기본키가 직접 결정하는 것이 아닌, 다른 속성을 통해 간접적으로 결정하는 경우를 뜻함

| 학번   | 학과 ID | 학과 이름    |
| ------ | ------- | ------------ |
| 201727 | 101     | 전기전자공학 |
| 201747 | 102     | 컴퓨터공학   |

- `학과 ID`는 `학번`에 의해서 결정
- `학과 이름`은 `학과 ID`에 의해서 결정

> `학번 -> 학과 ID -> 학과 이름` <br> `학과 ID`, '학과 이름'은 다른 속성에 의해서 간접적으로 결정됨

### BCNF (Boyce-codd Normal Form)

> 제3 정규화를 진행한 테이블에 대해 모든 결정자가 후보키가 되도록 테이블을 분해하는 것

- 결정자 : 어떤 속성이 다른 속성을 결정할 수 있으면 그 결정하는 쪽
  > 즉, `A -> B`에서 `A`가 결정자이고 후보키일 때, BCNF 충족

| 학번 | 강의명   | 교수   |
| ---- | -------- | ------ |
| 101  | 자료구조 | 김교수 |
| 102  | 자료구조 | 김교수 |
| 103  | 자료구조 | 김교수 |
| 104  | 인공지능 | 박교수 |

- 기본키 : (학번, 강의명) -> 복합키
- 교수 -> 기본키에 의해서 결정

> 기본키가 교수를 결정하기도 하지만, 교수가 특강 이름을 결정하기도 함. <br> 특강 이름을 결정하는 결정자 이지만 유일성을 만족하지 않기 때문에 후보키가 될 수 없음 <br> 그렇기 때문에 테이블을 분해하여, 교수 column이 후보키가 될 수 있도록 변경해야 함

| 학번 | 교수   |
| ---- | ------ |
| 101  | 김교수 |
| 102  | 김교수 |
| 103  | 김교수 |
| 104  | 박교수 |

| 강의명   | 교수   |
| -------- | ------ |
| 자료구조 | 김교수 |
| 인공지능 | 박교수 |

> 다음과 같이 테이블을 분리하면 BCNF를 만족하는 테이블이 됨
