- 네트워크에서 통신이 일어나는 과정을 7단계로 나눈 것.
- 흐름을 한눈에 알아보기 쉽고 특정 계층에 문제가 발생했을 때 다른 계층의 장비나 소프트웨어를 건드리지 않고 해당 계층만 수정하여 효율적으로 문제를 해결할 수 있음.
- TCP/IP 4계층: 사실상 인터넷 표준
- OSI 7계층: 국제표준화기구(ISO)에서 개발한 이론적이고 포괄적인 모델

<table border="1">
  <thead>
    <tr>
      <th>OSI 7계층</th>
      <th>TCP/IP 4계층</th>
      <th>프로토콜</th>
      <th>전송단위</th>
      <th>사용 장비</th>
      <th>특징</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>응용계층</td>
      <td rowspan="3">응용 계층</td>
      <td rowspan="3">TCP - HTTP(80), HTTPS(443), FTP(20, 21), SMTP(25), TELNET(23), SSH(22)<br>
          UDP - DNS(53), SNMP(161, 162), DHCP(67)</td>
      <td rowspan="3">Data</td>
      <td rowspan="3">L7 스위치(방화벽)</td>
      <td>응용 프로그램</td>
    </tr>
    <tr>
      <td>표현계층</td>
      <td>압축, 암호화</td>
    </tr>
    <tr>
      <td>세션계층</td>
      <td>응용프로그램들 간의 통신관리 및 동기화 유지</td>
    </tr>
    <tr>
      <td>전송계층</td>
      <td>전송 계층</td>
      <td>TCP, UDP</td>
      <td>Segment(TCP)<br>Datagram(UDP)</td>
      <td>L4 스위치(로드밸런싱)</td>
      <td>양 종단간 신뢰성 있는 정보 전달 (흐름 제어, 오류 제어)</td>
    </tr>
    <tr>
      <td>네트워크 계층</td>
      <td>인터넷 계층</td>
      <td>IP, ICMP, IGMP, ARP, RARP</td>
      <td>Packet</td>
      <td>L3 스위치(라우터)</td>
      <td>비연결성, 비신뢰성</td>
    </tr>
    <tr>
      <td>데이터 링크 계층</td>
      <td rowspan="2">네트워크 액세스 계층</td>
      <td rowspan="2">Ethernet, X.25, RS-232C</td>
      <td>Frame</td>
      <td>L2 스위치, 브리지</td>
      <td>인접한 노드들 간 신뢰성 있는 정보 전달</td>
    </tr>
    <tr>
      <td>물리 계층</td>
      <td>Bit</td>
      <td>NIC, 허브, 리피터</td>
      <td>프레임을 비트로 변환해서 전송</td>
    </tr>
  </tbody>
</table>

---
### 응용 계층(application layer)
- 사용자-소프트웨어 간 소통을 담당하는 계층.
- 프로토콜: HTTP, HTTPS, DNS 등

---

### 표현 계층(presentation layer)
- 인코딩과 압축, 암호화와 같은 작업을 수행 
- 세션 계층과 표현 계층은 다른 계층과 달리, 두 계층을 명확하게 구분하지 않거나 응용 계층에 포함하여 간주하는 경우가 많음.

---

### 세션 계층(session layer)
- 응용 프로그램 간의 연결 상태를 의미하는 세션session을 관리하기 위한 계층 
- 즉, 응용 프로그램 간의 연결 상태를 유지하거나 새롭게 생성하고, 필요하다면 연결을 끊는 역할을 수행

---

### 전송 계층(transport layer)
- 네트워크를 통해 송수신되는 패킷은 전송 도중에 유실될 때도 있고, 순서가 뒤바뀔 때도 있음. 전송 계층은 이러한 상황에 대비해 신뢰성 있는 전송을 가능하게 하는 계층
- 포트(Port)라는 정보를 통해 특정 응용 프로그램과의 연결 다리 역할을 수행하는 계층이기도 함 
- 프로토콜: TCP, UDP

#### TCP, UDP Header
![](https://velog.velcdn.com/images/ekdeon/post/e1cf0f9f-6c14-4ef9-9aa6-faf3accef1fa/image.png)

- SYN: 연결 요청 플래그
- ACK: 응답 플래그

#### TCP 연결 성립 과정(3 Way-Handshake)
![](https://velog.velcdn.com/images/ekdeon/post/730c4f06-e49d-447f-9f08-764cef1ba781/image.png)

**과정**
- ① 클라이언트는 서버에 클라이언트의 ISN을 담아 SYN을 보냄.  
  - ISN: 초기 네트워크 연결을 할 때 할당된 32비트 고유 시퀀스 번호
- ② 서버는 클라이언트의 SYN을 수신하고 서버의 ISN을 보내며 승인번호로 클라이언트의 ISN + 1을 보냄.
- ③ 클라이언트는 서버의 ISN + 1한 값인 승인번호를 담아 ACK를 서버에 보냄

#### TCP 연결 해제 과정(4 Way-Handshake)
![](https://velog.velcdn.com/images/ekdeon/post/3a4a9c28-0235-4091-9d4d-72ba2124f8a7/image.png)

**과정**
- ① 클라이언트가 연결을 닫으려고 할 때 FIN으로 설정된 세그먼트 전송. 그리고 클라이언트는 FIN_WAIT_1 상태로 들어가고 서버의 응답을 기다림.
- ② 서버는 클라이언트로 ACK라는 승인 세그먼트를 보냄. 그리고 CLOSE_WAIT 상태에 들어감. 클라이언트가 세그먼트를 받으면 FIN_WAIT_2 상태에 들어감.
- ③ 서버는 ACK를 보내고 일정 시간 이후에 클라이언트에 FIN 세그먼트 보냄.

- ④ 클라이언트는 TIME_WAIT 상태가 되고, 다시 서버로 ACK를 보내서 서버는 CLOSED 상태가 됨. 이후 클라이언트는 어느 정도의 시간을 대기한 후 연결이 닫히고 클라이언트와 서버의 모든 자원의 연결이 해제됨.

**TIME WAIT**
- 소켓이 바로 소멸되지 않고 일정 시간 유지되는 상태로, 지연 패킷 등의 문제점을 해결하는 데 쓰임.

일정 시간 이후에 닫는 이유?
- 지연 패킷이 발생할 경우를 대비하기 위함.
  - 서버에서 FIN 패킷보다 이전에 전송한 패킷이 Routing 지연이나 패킷 유실로 인한 재전송 등으로 인해 FIN패킷보다 늦게 도착하는 상황에서 이를 처리하지 못한다면 데이터 무결성 문제가 발생함.
- 두 장치가 연결이 닫혔는지 확인하기 위함. 
  - 만약 LAST_ACK 상태에서 닫히게 되면 다시 새로운 연결을 하려고 할 때 장치는 줄곧 LAST_ACK로 되어 있기 때문에 접속 오류가 발생함

#### 패킷 교환 방식

**가상회선**

- 연결형 통신(TCP)에서 주로 사용되는 방식. 출발지와 목적지의 전송
경로를 미리 연결하여 논리적으로 고정한 후 통신하는 방식
![](https://velog.velcdn.com/images/ekdeon/post/da542764-cdc6-40ae-a6e2-cc19dfdde6d9/image.png)

**데이터그램**

- 비연결형 통신(UDP)에서 주로 사용되는 방식으로, 사전에 접속 절차
를 수행하지 않고 헤더에 출발지에서 목적지까지의 경로 지정을
위한 충분한 정보를 붙여서 개별적으로 전달하는 방식
![](https://velog.velcdn.com/images/ekdeon/post/51affe33-764f-449d-8e1e-bc9758a2930d/image.png)

---

### 네트워크 계층(network layer)
- 네트워크 간 통신을 가능하게 하는 계층
- 데이터 링크 계층이 기본적으로 같은 LAN에 속한 호스트끼리 올바르게 정보를 주고받기 위해 필요한 계층이라면, 네트워크 계층은 LAN을 넘어 다른 네트워크와 통신을 주고받기 위해 필요한 계층
- 따라서 네트워크 간 통신 과정에서 호스트를 식별할 수 있는 주소(IP 주소)가 필요함 
- 프로토콜: IP

---

### 데이터 링크 계층(data link layer)
- 같은 LAN에 속한 호스트끼리 올바르게 정보를 주고받기 위한 계층
- 같은 네트워크에 속한 호스트를 식별할 수 있는 주소(MAC 주소)를 사용하고, 물리계층을 통해 주고받는 정보에 오류가 없는지 확인하기도 함
- 물리 계층과 데이터 링크 계층은 서로 밀접하게 연관된 계층이며, 하드웨어와 밀접하게 맞닿아 있는 계층임

---

### 물리 계층(physical layer)
- 유무선 통신 매체를 통해 비트 신호를 주고받는 계층
- 컴퓨터는 0과 1만을 이해할 수 있기 때문에 네트워크를 통해 주고받는 정보 또한 0과 1로 이루어진 신호로 구성됨. 

---

![](https://velog.velcdn.com/images/ekdeon/post/85c31559-abd7-41e6-85ac-e088d2029f86/image.png)

- 캡슐화(encapsulation): 송신 과정에서 헤더(및 트레일러)를 추가해 나가는 과정
- 역캡슐화(decapsulation): 캡슐화 과정에서 붙인 헤더(및 트레일러)를 각 계층에서 확인한 뒤 제거하는 과정

---

참고: 
- 면접을 위한 CS 전공지식 노트
- 이것이 취업을 위한 컴퓨터 과학이다 with CS 기술 면접



 


 
